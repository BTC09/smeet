<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SMEET Detailing</title>
    <!-- Telegram Web App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            background-color: #f5f5f7;
            color: #1d1d1f;
            padding: 20px 16px;
            min-height: 100vh;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        body.loaded {
            opacity: 1;
        }

        /* –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –¥–∏–∑–∞–π–Ω */
        .header {
            margin-bottom: 32px;
            text-align: left;
        }

        .logo {
            font-size: 40px;
            font-weight: 700;
            letter-spacing: -1px;
            color: #000;
            margin-bottom: 8px;
        }

        .logo span {
            color: #86868b;
            font-weight: 400;
        }

        .subtitle {
            font-size: 16px;
            color: #86868b;
            line-height: 1.4;
        }

        /* –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥ */
        .section-title {
            font-size: 20px;
            font-weight: 600;
            margin: 28px 0 16px;
            letter-spacing: -0.5px;
        }

        .services-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .service-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            border: 1px solid rgba(0, 0, 0, 0.05);
            transition: all 0.2s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .service-card:hover {
            transform: scale(1.02);
            background: rgba(255, 255, 255, 0.95);
            border-color: rgba(0, 0, 0, 0.1);
        }

        .service-card.selected {
            border: 2px solid #000;
            background: #fff;
        }

        .service-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .service-name {
            font-size: 18px;
            font-weight: 600;
            color: #1d1d1f;
        }

        .service-price {
            font-size: 20px;
            font-weight: 700;
            color: #000;
        }

        .service-description {
            font-size: 14px;
            color: #86868b;
            margin-bottom: 12px;
            line-height: 1.4;
            padding-right: 20px;
        }

        .service-details {
            display: flex;
            gap: 16px;
            font-size: 13px;
            color: #6e6e73;
        }

        .service-details span {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* –ë–µ–π–¥–∂–∏ */
        .badge {
            background: #000;
            color: #fff;
            padding: 4px 10px;
            border-radius: 30px;
            font-size: 11px;
            font-weight: 500;
            letter-spacing: 0.3px;
            display: inline-block;
            margin-right: 6px;
        }

        .badge.premium {
            background: #c4a962;
        }

        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏ */
        .options-section {
            margin-top: 32px;
            padding-top: 20px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .option-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .option-item:last-child {
            border-bottom: none;
        }

        .option-info {
            flex: 1;
        }

        .option-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .option-desc {
            font-size: 13px;
            color: #86868b;
        }

        .option-price {
            font-size: 16px;
            font-weight: 600;
            margin-left: 16px;
        }

        /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å */
        .switch {
            position: relative;
            display: inline-block;
            width: 44px;
            height: 24px;
            margin-left: 12px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #e0e0e0;
            transition: .3s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: .3s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #000;
        }

        input:checked + .slider:before {
            transform: translateX(20px);
        }

        /* –ö–æ—Ä–∑–∏–Ω–∞/–∏—Ç–æ–≥–æ */
        .cart-bar {
            position: fixed;
            bottom: 20px;
            left: 16px;
            right: 16px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 16px 20px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            transform: translateY(100px);
            transition: transform 0.3s ease;
            z-index: 100;
        }

        .cart-bar.visible {
            transform: translateY(0);
        }

        .cart-info {
            display: flex;
            flex-direction: column;
        }

        .cart-label {
            font-size: 12px;
            opacity: 0.7;
            letter-spacing: 0.5px;
        }

        .cart-total {
            font-size: 22px;
            font-weight: 700;
        }

        .cart-button {
            background: white;
            color: black;
            border: none;
            padding: 12px 24px;
            border-radius: 30px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .cart-button:hover {
            transform: scale(1.05);
            background: #f0f0f0;
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 12px 24px;
            border-radius: 30px;
            font-size: 14px;
            z-index: 200;
            transition: transform 0.3s ease;
            white-space: nowrap;
            backdrop-filter: blur(10px);
        }

        .notification.show {
            transform: translateX(-50%) translateY(0);
        }

        /* –î–µ—Ç–∞–ª–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è */
        .car-details {
            background: #fff;
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 24px;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .car-details-title {
            font-size: 14px;
            color: #86868b;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .car-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            font-size: 15px;
            margin-bottom: 12px;
            background: #f8f8f8;
        }

        .car-input:focus {
            outline: none;
            border-color: #000;
            background: #fff;
        }

        /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ Telegram —Ç–µ–º—É */
        body[data-theme="dark"] {
            background-color: #1c1c1e;
            color: #ffffff;
        }

        body[data-theme="dark"] .service-card {
            background: rgba(44, 44, 46, 0.8);
            border-color: rgba(255, 255, 255, 0.1);
        }

        body[data-theme="dark"] .service-name {
            color: #fff;
        }

        body[data-theme="dark"] .badge {
            background: #3a3a3c;
        }
    </style>
</head>
<body>
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
    <div class="notification" id="notification">–£—Å–ª—É–≥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞</div>

    <!-- –®–∞–ø–∫–∞ -->
    <div class="header">
        <div class="logo">SMEET<span>.</span></div>
        <div class="subtitle">–ü—Ä–µ–º–∏–∞–ª—å–Ω—ã–π –¥–µ—Ç–µ–π–ª–∏–Ω–≥<br>–¥–ª—è —Ü–µ–Ω–∏—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–∞</div>
    </div>

    <!-- –î–µ—Ç–∞–ª–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è (–º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è —Ñ–æ—Ä–º–∞) -->
    <div class="car-details">
        <div class="car-details-title">üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≤—Ç–æ–º–æ–±–∏–ª–µ</div>
        <input type="text" class="car-input" id="carBrand" placeholder="–ú–∞—Ä–∫–∞ –∏ –º–æ–¥–µ–ª—å">
        <input type="text" class="car-input" id="carYear" placeholder="–ì–æ–¥ –≤—ã–ø—É—Å–∫–∞">
    </div>

    <!-- –≠–∫—Å—Ç–µ—Ä—å–µ—Ä -->
    <div class="section-title">‚ú® –≠–∫—Å—Ç–µ—Ä—å–µ—Ä</div>
    <div class="services-grid" id="exteriorServices">
        <!-- –£—Å–ª—É–≥–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
    </div>

    <!-- –ò–Ω—Ç–µ—Ä—å–µ—Ä -->
    <div class="section-title">üõãÔ∏è –ò–Ω—Ç–µ—Ä—å–µ—Ä</div>
    <div class="services-grid" id="interiorServices"></div>

    <!-- –ó–∞—â–∏—Ç–Ω—ã–µ –ø–æ–∫—Ä—ã—Ç–∏—è -->
    <div class="section-title">üõ°Ô∏è –ó–∞—â–∏—Ç–Ω—ã–µ –ø–æ–∫—Ä—ã—Ç–∏—è</div>
    <div class="services-grid" id="protectionServices"></div>

    <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏ -->
    <div class="options-section">
        <div class="section-title">‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</div>
        
        <div class="option-item">
            <div class="option-info">
                <div class="option-title">–ù–∞–Ω–æ-–∑–∞—â–∏—Ç–∞ —Å—Ç–µ–∫–æ–ª</div>
                <div class="option-desc">–ì–∏–¥—Ä–æ—Ñ–æ–±–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –Ω–∞ 12 –º–µ—Å—è—Ü–µ–≤</div>
            </div>
            <div class="option-price">3 900 ‚ÇΩ</div>
            <label class="switch">
                <input type="checkbox" id="glassProtection" onchange="updateTotal()">
                <span class="slider"></span>
            </label>
        </div>

        <div class="option-item">
            <div class="option-info">
                <div class="option-title">–ê—Ä–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å–∞–ª–æ–Ω–∞</div>
                <div class="option-desc">–ü—Ä–µ–º–∏–∞–ª—å–Ω—ã–π –∞—Ä–æ–º–∞—Ç –Ω–∞ –≤—ã–±–æ—Ä</div>
            </div>
            <div class="option-price">1 900 ‚ÇΩ</div>
            <label class="switch">
                <input type="checkbox" id="fragrance" onchange="updateTotal()">
                <span class="slider"></span>
            </label>
        </div>

        <div class="option-item">
            <div class="option-info">
                <div class="option-title">–ß–µ—Ä–Ω–µ–Ω–∏–µ —Ä–µ–∑–∏–Ω—ã</div>
                <div class="option-desc">–ú–∞—Ç–æ–≤—ã–π –∏–ª–∏ –≥–ª—è–Ω—Ü–µ–≤—ã–π —Ñ–∏–Ω–∏—à</div>
            </div>
            <div class="option-price">1 500 ‚ÇΩ</div>
            <label class="switch">
                <input type="checkbox" id="tireShine" onchange="updateTotal()">
                <span class="slider"></span>
            </label>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å —Å –∏—Ç–æ–≥–æ–º -->
    <div class="cart-bar" id="cartBar">
        <div class="cart-info">
            <span class="cart-label">–ò—Ç–æ–≥–æ</span>
            <span class="cart-total" id="totalAmount">0 ‚ÇΩ</span>
        </div>
        <button class="cart-button" id="orderButton">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand(); // –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
        tg.ready();

        // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ç–µ–º—É Telegram
        document.body.classList.add('loaded');
        if (tg.colorScheme === 'dark') {
            document.body.setAttribute('data-theme', 'dark');
        }

        // –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É—Å–ª—É–≥
        const services = {
            exterior: [
                {
                    id: 'ext1',
                    name: '–ú–æ–π–∫–∞ –ø—Ä–µ–º–∏—É–º',
                    price: 3500,
                    description: '–ë–µ—Å–∫–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –º–æ–π–∫–∞, —Ä—É—á–Ω–∞—è —Å—É—à–∫–∞, –æ—á–∏—Å—Ç–∫–∞ –¥–∏—Å–∫–æ–≤ –∏ –∞—Ä–æ–∫',
                    time: '60 –º–∏–Ω',
                    badge: '–•–ò–¢'
                },
                {
                    id: 'ext2',
                    name: '–ó–∞—â–∏—Ç–Ω–∞—è –ø–æ–ª–∏—Ä–æ–≤–∫–∞',
                    price: 8500,
                    description: '–£–¥–∞–ª–µ–Ω–∏–µ –≥–æ–ª–æ–≥—Ä–∞–º–º, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –õ–ö–ü, –Ω–∞–Ω–µ—Å–µ–Ω–∏–µ –∑–∞—â–∏—Ç—ã',
                    time: '4 —á–∞—Å–∞',
                    badge: 'PREMIUM'
                },
                {
                    id: 'ext3',
                    name: '–ê–Ω—Ç–∏–≥–æ–ª–æ–≥—Ä–∞–º–º–Ω–∞—è –ø–æ–ª–∏—Ä–æ–≤–∫–∞',
                    price: 12500,
                    description: '–ú–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è, —Ñ–∏–Ω–∏—à–Ω–∞—è –ø–æ–ª–∏—Ä–æ–≤–∫–∞, –∫–µ—Ä–∞–º–∏–∫–∞',
                    time: '8 —á–∞—Å–æ–≤',
                    badge: 'VIP'
                },
                {
                    id: 'ext4',
                    name: '–û—á–∏—Å—Ç–∫–∞ –¥–∏—Å–∫–æ–≤ –∏ –∞—Ä–æ–∫',
                    price: 2500,
                    description: '–î–µ–º–æ–Ω—Ç–∞–∂ –∫–æ–ª–µ—Å, –æ—á–∏—Å—Ç–∫–∞ –æ—Ç —Ç–æ—Ä–º–æ–∑–Ω–æ–π –ø—ã–ª–∏, –∑–∞—â–∏—Ç–∞ —Å–æ—Å—Ç–∞–≤–æ–º',
                    time: '90 –º–∏–Ω'
                }
            ],
            interior: [
                {
                    id: 'int1',
                    name: '–•–∏–º—á–∏—Å—Ç–∫–∞ —Å–∞–ª–æ–Ω–∞ (–ª–µ–≥–∫–∞—è)',
                    price: 4500,
                    description: '–ü—ã–ª–µ—Å–æ—Å, –æ—á–∏—Å—Ç–∫–∞ –ø–ª–∞—Å—Ç–∏–∫–∞, —Å—Ç–µ–∫–æ–ª, –∫–æ–≤—Ä–æ–≤',
                    time: '2 —á–∞—Å–∞'
                },
                {
                    id: 'int2',
                    name: '–•–∏–º—á–∏—Å—Ç–∫–∞ —Å–∞–ª–æ–Ω–∞ (–ø–æ–ª–Ω–∞—è)',
                    price: 9500,
                    description: '–ì–ª—É–±–æ–∫–∞—è —á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–µ–π, –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–∂–∏',
                    time: '5 —á–∞—Å–æ–≤',
                    badge: 'PREMIUM'
                },
                {
                    id: 'int3',
                    name: '–ß–∏—Å—Ç–∫–∞ –∏ –ø—Ä–æ–ø–∏—Ç–∫–∞ –∫–æ–∂–∏',
                    price: 5500,
                    description: '–î–µ–ª–∏–∫–∞—Ç–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞, –ø–∏—Ç–∞–Ω–∏–µ, –∑–∞—â–∏—Ç–∞ –æ—Ç –∏–∑–Ω–æ—Å–∞',
                    time: '3 —á–∞—Å–∞'
                },
                {
                    id: 'int4',
                    name: '–û–∑–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–µ–∑–∏–Ω—Ñ–µ–∫—Ü–∏—è',
                    price: 2900,
                    description: '–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∞—Ö–æ–≤, —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –±–∞–∫—Ç–µ—Ä–∏–π',
                    time: '1 —á–∞—Å'
                }
            ],
            protection: [
                {
                    id: 'prot1',
                    name: '–ñ–∏–¥–∫–æ–µ —Å—Ç–µ–∫–ª–æ',
                    price: 7900,
                    description: '–ó–∞—â–∏—Ç–∞ –Ω–∞ 6 –º–µ—Å—è—Ü–µ–≤, –≥–∏–¥—Ä–æ—Ñ–æ–±–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç',
                    time: '3 —á–∞—Å–∞',
                    badge: '–ü–û–ü–£–õ–Ø–†–ù–û–ï'
                },
                {
                    id: 'prot2',
                    name: '–ö–µ—Ä–∞–º–∏—á–µ—Å–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ 9H',
                    price: 18900,
                    description: '–ó–∞—â–∏—Ç–∞ –Ω–∞ 2 –≥–æ–¥–∞, –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω—ã–π –±–ª–µ—Å–∫ –∏ —Ç–≤–µ—Ä–¥–æ—Å—Ç—å',
                    time: '12 —á–∞—Å–æ–≤',
                    badge: 'PREMIUM'
                },
                {
                    id: 'prot3',
                    name: '–ó–∞—â–∏—Ç–Ω–∞—è –ø–ª–µ–Ω–∫–∞ (–±–∞–º–ø–µ—Ä)',
                    price: 12900,
                    description: '–ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–∫–æ–ª–æ–≤ –∏ —Ü–∞—Ä–∞–ø–∏–Ω',
                    time: '5 —á–∞—Å–æ–≤'
                },
                {
                    id: 'prot4',
                    name: '–ü–æ–ª–Ω–∞—è –æ–∫–ª–µ–π–∫–∞ –ø–ª–µ–Ω–∫–æ–π',
                    price: 245000,
                    description: '–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç, –ø—Ä–µ–º–∏–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞',
                    time: '3 –¥–Ω—è',
                    badge: 'VIP'
                }
            ]
        };

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —É—Å–ª—É–≥
        let selectedServices = new Set();
        let total = 0;

        // –†–µ–Ω–¥–µ—Ä–∏–º —É—Å–ª—É–≥–∏
        function renderServices() {
            // –≠–∫—Å—Ç–µ—Ä—å–µ—Ä
            const exteriorContainer = document.getElementById('exteriorServices');
            services.exterior.forEach(service => {
                exteriorContainer.appendChild(createServiceCard(service));
            });

            // –ò–Ω—Ç–µ—Ä—å–µ—Ä
            const interiorContainer = document.getElementById('interiorServices');
            services.interior.forEach(service => {
                interiorContainer.appendChild(createServiceCard(service));
            });

            // –ó–∞—â–∏—Ç–∞
            const protectionContainer = document.getElementById('protectionServices');
            services.protection.forEach(service => {
                protectionContainer.appendChild(createServiceCard(service));
            });
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —É—Å–ª—É–≥–∏
        function createServiceCard(service) {
            const card = document.createElement('div');
            card.className = 'service-card';
            card.dataset.id = service.id;
            card.dataset.price = service.price;
            card.dataset.name = service.name;

            let badgeHtml = '';
            if (service.badge) {
                const badgeClass = service.badge === 'PREMIUM' || service.badge === 'VIP' ? 'badge premium' : 'badge';
                badgeHtml = `<span class="${badgeClass}">${service.badge}</span>`;
            }

            card.innerHTML = `
                <div class="service-header">
                    <span class="service-name">${badgeHtml} ${service.name}</span>
                    <span class="service-price">${service.price.toLocaleString()} ‚ÇΩ</span>
                </div>
                <div class="service-description">${service.description}</div>
                <div class="service-details">
                    <span>‚è±Ô∏è ${service.time}</span>
                </div>
            `;

            card.addEventListener('click', () => toggleService(service.id, service.price, service.name, card));
            return card;
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏
        function toggleService(id, price, name, card) {
            if (selectedServices.has(id)) {
                selectedServices.delete(id);
                card.classList.remove('selected');
                showNotification(`‚ùå ${name} —É–¥–∞–ª–µ–Ω–∞`);
            } else {
                selectedServices.add(id);
                card.classList.add('selected');
                showNotification(`‚úÖ ${name} –¥–æ–±–∞–≤–ª–µ–Ω–∞`);
            }
            updateTotal();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Ç–æ–≥–æ–≤–æ–π —Å—É–º–º—ã
        function updateTotal() {
            total = 0;
            
            // –°—á–∏—Ç–∞–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —É—Å–ª—É–≥–∏
            selectedServices.forEach(id => {
                // –ò—â–µ–º —É—Å–ª—É–≥—É –≤–æ –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö
                const allServices = [...services.exterior, ...services.interior, ...services.protection];
                const service = allServices.find(s => s.id === id);
                if (service) {
                    total += service.price;
                }
            });

            // –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø. –æ–ø—Ü–∏–∏
            if (document.getElementById('glassProtection').checked) total += 3900;
            if (document.getElementById('fragrance').checked) total += 1900;
            if (document.getElementById('tireShine').checked) total += 1500;

            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            document.getElementById('totalAmount').textContent = total.toLocaleString() + ' ‚ÇΩ';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É
            const cartBar = document.getElementById('cartBar');
            if (total > 0) {
                cartBar.classList.add('visible');
            } else {
                cartBar.classList.remove('visible');
            }
        }

        // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function showNotification(text) {
            const notification = document.getElementById('notification');
            notification.textContent = text;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 1500);
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–∫–∏ –≤ Telegram
        function sendOrder() {
            if (total === 0) {
                showNotification('‚ùå –í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —É—Å–ª—É–≥—É');
                return;
            }

            // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            const carBrand = document.getElementById('carBrand').value || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
            const carYear = document.getElementById('carYear').value || '–ù–µ —É–∫–∞–∑–∞–Ω';
            
            // –ü–æ–ª—É—á–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —É—Å–ª—É–≥
            const selectedServicesList = [];
            selectedServices.forEach(id => {
                const allServices = [...services.exterior, ...services.interior, ...services.protection];
                const service = allServices.find(s => s.id === id);
                if (service) selectedServicesList.push(service.name);
            });

            // –î–æ–ø. –æ–ø—Ü–∏–∏
            const extras = [];
            if (document.getElementById('glassProtection').checked) extras.push('–ù–∞–Ω–æ-–∑–∞—â–∏—Ç–∞ —Å—Ç–µ–∫–æ–ª');
            if (document.getElementById('fragrance').checked) extras.push('–ê—Ä–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è');
            if (document.getElementById('tireShine').checked) extras.push('–ß–µ—Ä–Ω–µ–Ω–∏–µ —Ä–µ–∑–∏–Ω—ã');

            // –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            const message = `
üöó –ù–û–í–ê–Ø –ó–ê–Ø–í–ö–ê SMEET

üìã –ê–≤—Ç–æ–º–æ–±–∏–ª—å: ${carBrand} (${carYear})

üõ†Ô∏è –£—Å–ª—É–≥–∏:
${selectedServicesList.map(s => '‚Ä¢ ' + s).join('\n')}

${extras.length ? '‚ú® –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:\n' + extras.map(e => '‚Ä¢ ' + e).join('\n') : ''}

üí∞ –ò—Ç–æ–≥–æ: ${total.toLocaleString()} ‚ÇΩ

‚è∞ –û–∂–∏–¥–∞–π—Ç–µ –∑–≤–æ–Ω–∫–∞ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏
            `;

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –±–æ—Ç
            tg.sendData(JSON.stringify({
                car: carBrand,
                year: carYear,
                services: selectedServicesList,
                extras: extras,
                total: total,
                message: message
            }));

            showNotification('‚úÖ –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!');
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º WebApp —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                tg.close();
            }, 1500);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        renderServices();
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –∑–∞–∫–∞–∑–∞
        document.getElementById('orderButton').addEventListener('click', sendOrder);

        // –ì–ª–∞–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ Telegram (–Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ö–æ—á–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë)
        tg.MainButton.setText('–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É');
        tg.MainButton.onClick(sendOrder);

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º MainButton –∫–æ–≥–¥–∞ –µ—Å—Ç—å —Å—É–º–º–∞ > 0
        let lastTotal = 0;
        setInterval(() => {
            if (total > 0 && total !== lastTotal) {
                tg.MainButton.show();
                lastTotal = total;
            } else if (total === 0 && lastTotal !== 0) {
                tg.MainButton.hide();
                lastTotal = 0;
            }
        }, 100);
    </script>
</body>
</html>
