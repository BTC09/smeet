<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SMEET Casino - Plinko</title>
<style>
body{margin:0;overflow:hidden;background:#000;font-family:Arial;}
canvas{display:block;}

#welcome{
  position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
  font-size:80px;color:#FFD700;text-shadow:0 0 10px #FFD700,0 0 20px #FFD700;
  white-space:nowrap;overflow:hidden;clip-path:inset(0 100% 0 0);
  animation:revealText 2s forwards ease-out; z-index:10;
}
@keyframes revealText{from{clip-path:inset(0 100% 0 0);}to{clip-path:inset(0 0 0 0);}}
.fade-out{animation:fadeOut 1s forwards;}
@keyframes fadeOut{from{opacity:1;}to{opacity:0;}}

#menu{
  position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
  color:#fff;text-align:center; display:none; z-index:10;
}
#menu button{font-size:25px;margin:15px;padding:10px 30px;background:#222;color:#FFD700;border:2px solid #FFD700;cursor:pointer;border-radius:10px;transition:0.3s;}
#menu button:hover{background:#FFD700;color:#000;}

#ui{
  position:absolute;top:10px;left:10px;color:#fff; z-index:10;font-size:20px;
}
#ui label{margin-right:10px;}
</style>
</head>
<body>

<div id="welcome">üé∞ SMEET üé∞</div>
<div id="menu">
<h2>–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É</h2>
<button onclick="startPlinko()">–ü–ª–∏–Ω–∫–æ</button>
<button onclick="alert('–°–ª–æ—Ç—ã –ø–æ–∫–∞ –Ω–µ –≥–æ—Ç–æ–≤—ã!')">–°–ª–æ—Ç—ã</button>
</div>

<div id="ui" style="display:none;">
  <label>–ë–∞–ª–∞–Ω—Å: <span id="balance">1000</span></label>
  <label>–°—Ç–∞–≤–∫–∞: <input type="number" id="bet" value="50" min="10" max="1000" style="width:60px"></label>
  <button onclick="dropBall()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —à–∞—Ä–∏–∫</button>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas=document.getElementById('gameCanvas');
const ctx=canvas.getContext('2d');
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

// ---------- —Ñ–æ–Ω ----------
const stars=[], comets=[];
for(let i=0;i<200;i++) stars.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,radius:Math.random()*1.5+0.5,alpha:Math.random(),alphaChange:Math.random()*0.01+0.002});
for(let i=0;i<5;i++) comets.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height/2,speedX:Math.random()*2+1,speedY:Math.random()*2+1,radius:Math.random()*3+2,trail:[]});

// ---------- –ü–ª–∏–Ω–∫–æ ----------
let plinkoActive=false;
const cols=11, pinRadius=6, pinSpacingX=80, pinSpacingY=80, ballRadius=12;
let sections=[], pins=[], balls=[];
let balance=1000, history=[];

function initPlinko(){
  sections=[]; pins=[]; balls=[];
  // —Å–æ–∑–¥–∞—ë–º —Å–µ–∫—Ü–∏–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ –ø—Ä–∏–∑–∞–º–∏
  const prizes=[100,50,0,200,50,0,200,50,0,100,150];
  for(let i=0;i<cols;i++){
    sections.push({x:i*(canvas.width/cols), width:canvas.width/cols, prize:prizes[i], color:`hsl(${Math.random()*360},70%,50%)`});
  }
  // —à—Ç—ã—Ä–∏ –≤ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
  const rows=7;
  for(let row=0; row<rows; row++){
    for(let col=0; col<cols; col++){
      const offset=row%2===0?0:pinSpacingX/2;
      const x=col*pinSpacingX+offset+(canvas.width-cols*pinSpacingX)/2;
      const y=row*pinSpacingY+150;
      pins.push({x,y});
    }
  }
}

function dropBall(){
  const bet=parseInt(document.getElementById('bet').value);
  if(balance<bet) return alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–∞–ª–∞–Ω—Å–∞!');
  balance-=bet;
  document.getElementById('balance').innerText=balance;
  balls.push({x:canvas.width/2, y:50, vx:(Math.random()*2-1)*3, vy:0, bet});
}

// ---------- –ê–Ω–∏–º–∞—Ü–∏—è ----------
function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // –∑–≤—ë–∑–¥—ã
  stars.forEach(s=>{
    ctx.beginPath(); ctx.arc(s.x,s.y,s.radius,0,Math.PI*2); ctx.fillStyle=`rgba(255,255,255,${s.alpha})`; ctx.fill(); ctx.closePath();
    s.alpha+=s.alphaChange; if(s.alpha>1||s.alpha<0) s.alphaChange*=-1;
  });

  // –∫–æ–º–µ—Ç—ã
  comets.forEach(c=>{
    c.trail.push({x:c.x,y:c.y});
    if(c.trail.length>20) c.trail.shift();
    c.trail.forEach((p,i)=>{
      const alpha=i/c.trail.length*0.5;
      ctx.beginPath(); ctx.arc(p.x,p.y,c.radius,0,Math.PI*2); ctx.fillStyle=`rgba(255,255,255,${alpha})`; ctx.fill(); ctx.closePath();
    });
    ctx.beginPath(); ctx.arc(c.x,c.y,c.radius,0,Math.PI*2); ctx.fillStyle='#fff'; ctx.fill(); ctx.closePath();
    c.x+=c.speedX; c.y+=c.speedY;
    if(c.x>canvas.width+50||c.y>canvas.height+50){c.x=Math.random()*canvas.width;c.y=-50;c.trail=[];}
  });

  if(plinkoActive){
    // —Å–µ–∫—Ü–∏–∏
    sections.forEach(s=>{
      ctx.fillStyle=s.color;
      ctx.fillRect(s.x,canvas.height-50,s.width,50);
      ctx.fillStyle='#fff'; ctx.font='20px Arial';
      ctx.fillText(s.prize, s.x+s.width/2-10, canvas.height-20);
    });
    // –±–æ—Ä—Ç–∏–∫–∏
    ctx.fillStyle='#FFD700';
    ctx.fillRect(0,0,10,canvas.height);
    ctx.fillRect(canvas.width-10,0,10,canvas.height);
    // —à—Ç—ã—Ä–∏
    pins.forEach(pin=>{ctx.beginPath();ctx.arc(pin.x,pin.y,pinRadius,0,Math.PI*2);ctx.fillStyle='#FFD700';ctx.fill();ctx.closePath();});
    // —à–∞—Ä–∏–∫–∏
    balls.forEach((ball,i)=>{
      ball.vy+=0.35; ball.vx*=0.995; ball.x+=ball.vx; ball.y+=ball.vy;

      pins.forEach(pin=>{
        const dx=pin.x-ball.x, dy=pin.y-ball.y, dist=Math.sqrt(dx*dx+dy*dy);
        if(dist<pinRadius+ballRadius){
          const angle=Math.atan2(dy,dx);
          const target=pinRadius+ballRadius;
          const ax=Math.cos(angle)*(target-dist), ay=Math.sin(angle)*(target-dist);
          ball.x-=ax; ball.y-=ay;
          const bounce=0.7;
          ball.vx=-ball.vx*bounce; ball.vy=-ball.vy*bounce;
        }
      });

      if(ball.x-ballRadius<10){ball.x=10+ballRadius; ball.vx*=-0.7;}
      if(ball.x+ballRadius>canvas.width-10){ball.x=canvas.width-10-ballRadius; ball.vx*=-0.7;}
      if(ball.y+ballRadius>canvas.height-50){
        const sec=Math.floor(ball.x/(canvas.width/cols));
        balance+=ball.bet+sections[sec].prize;
        document.getElementById('balance').innerText=balance;
        history.push(sections[sec].prize);
        balls.splice(i,1);
      }

      ctx.beginPath(); ctx.arc(ball.x,ball.y,ballRadius,0,Math.PI*2); ctx.fillStyle='#ff5555'; ctx.fill(); ctx.closePath();
    });
  }

  requestAnimationFrame(animate);
}

animate();

// –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ ‚Üí –º–µ–Ω—é
const welcomeDiv=document.getElementById('welcome');
const menuDiv=document.getElementById('menu');
setTimeout(()=>{
  welcomeDiv.classList.add('fade-out');
  setTimeout(()=>{welcomeDiv.style.display='none'; menuDiv.style.display='block';},1000);
},3000);

function startPlinko(){ plinkoActive=true; menuDiv.style.display='none'; initPlinko(); document.getElementById('ui').style.display='block'; }
window.addEventListener('resize',()=>{canvas.width=window.innerWidth; canvas.height=window.innerHeight;});
</script>
</body>
</html>
