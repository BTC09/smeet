<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>SMEET CASINO</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      background: #0b0e14;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 10px;
    }

    /* –ü–†–ò–í–ï–¢–°–¢–í–ï–ù–ù–´–ô –≠–ö–†–ê–ù */
    .welcome-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at center, #1a1f2e, #0a0c15);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      transition: opacity 1s ease;
    }

    .welcome-content {
      text-align: center;
      padding: 20px;
    }

    .welcome-title {
      font-size: clamp(60px, 15vw, 120px);
      font-weight: 900;
      color: #ffd966;
      text-shadow: 0 0 30px #f0b429, 0 0 60px #ff8800;
      letter-spacing: 4px;
      margin-bottom: 20px;
      animation: slideInDown 1.2s ease;
      line-height: 1;
    }

    .welcome-subtitle {
      font-size: clamp(20px, 5vw, 32px);
      color: #b9c7da;
      text-shadow: 0 0 15px #4f9fff;
      animation: slideInUp 1.2s ease 0.2s both;
    }

    .loading-dots {
      margin-top: 30px;
      display: flex;
      justify-content: center;
      gap: 15px;
    }

    .loading-dots span {
      width: clamp(15px, 4vw, 20px);
      height: clamp(15px, 4vw, 20px);
      background: #ffd966;
      border-radius: 50%;
      animation: bounce 1.4s infinite;
      box-shadow: 0 0 20px #f0b429;
    }

    .loading-dots span:nth-child(2) { animation-delay: 0.2s; }
    .loading-dots span:nth-child(3) { animation-delay: 0.4s; }

    @keyframes slideInDown {
      from { transform: translateY(-100px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    @keyframes slideInUp {
      from { transform: translateY(100px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    @keyframes bounce {
      0%, 80%, 100% { transform: scale(0.6); opacity: 0.4; }
      40% { transform: scale(1.2); opacity: 1; }
    }

    /* –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† */
    .app {
      width: 100%;
      max-width: 1000px;
      background: #141a24;
      border-radius: clamp(24px, 5vw, 48px);
      padding: clamp(16px, 3vw, 24px);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.8);
      border: 1px solid #2d3848;
      opacity: 0;
      transform: scale(0.95);
      transition: opacity 0.8s ease, transform 0.8s ease;
      position: relative;
    }

    .app.visible {
      opacity: 1;
      transform: scale(1);
    }

    /* –®–ê–ü–ö–ê –° –ë–ê–õ–ê–ù–°–û–ú */
    .header {
      background: #0f151f;
      border-radius: 100px;
      padding: clamp(12px, 2vw, 15px) clamp(20px, 3vw, 30px);
      margin-bottom: clamp(16px, 3vw, 24px);
      display: flex;
      align-items: center;
      justify-content: space-between;
      border: 1px solid #334153;
      box-shadow: inset 0 2px 5px #00000055;
      flex-wrap: wrap;
      gap: 10px;
    }

    .balance-block {
      display: flex;
      align-items: center;
      gap: clamp(10px, 2vw, 20px);
      background: #1a2332;
      padding: clamp(6px, 1.5vw, 8px) clamp(20px, 4vw, 30px) clamp(6px, 1.5vw, 8px) clamp(15px, 3vw, 20px);
      border-radius: 60px;
      border: 1px solid #4d607c;
    }

    .stars-icon {
      font-size: clamp(24px, 5vw, 32px);
      filter: drop-shadow(0 0 8px gold);
    }

    .balance-value {
      font-size: clamp(24px, 5vw, 36px);
      font-weight: 800;
      color: #ffd966;
      text-shadow: 0 0 10px #f0b429;
    }

    .add-stars-btn {
      background: linear-gradient(145deg, #2a3a55, #1b263b);
      border: 2px solid #ffd966;
      color: #ffd966;
      font-size: clamp(16px, 3vw, 20px);
      font-weight: 700;
      padding: clamp(8px, 2vw, 12px) clamp(20px, 4vw, 30px);
      border-radius: 60px;
      cursor: pointer;
      transition: 0.2s;
      box-shadow: 0 4px 0 #0f1a2a;
      display: flex;
      align-items: center;
      gap: 8px;
      white-space: nowrap;
    }

    .add-stars-btn:active {
      transform: translateY(4px);
      box-shadow: 0 1px 0 #0f1a2a;
    }

    /* –ú–ï–ù–Æ –ò–ì–† */
    .games-menu {
      display: flex;
      flex-direction: column;
      gap: 20px;
      padding: 20px 0;
    }

    .game-menu-item {
      background: #1e2a3a;
      border: 3px solid #ffd966;
      border-radius: 60px;
      padding: clamp(20px, 4vw, 30px);
      font-size: clamp(32px, 6vw, 48px);
      font-weight: 800;
      color: #ffd966;
      cursor: pointer;
      transition: 0.3s;
      text-transform: uppercase;
      letter-spacing: 2px;
      text-align: center;
      box-shadow: 0 8px 0 #0f1a2a;
    }

    .game-menu-item:active {
      transform: translateY(6px);
      box-shadow: 0 2px 0 #0f1a2a;
      background: #ffd966;
      color: #1a2538;
    }

    .game-menu-item.disabled {
      opacity: 0.4;
      cursor: not-allowed;
      border-color: #6c7a96;
      color: #6c7a96;
      box-shadow: 0 4px 0 #0f1a2a;
    }

    .game-menu-item.disabled:active {
      transform: translateY(4px);
      background: #1e2a3a;
      color: #6c7a96;
    }

    /* PLINKO –ö–û–ù–¢–ï–ô–ù–ï–† */
    #plinkoContainer {
      display: none;
    }

    #plinkoContainer.active {
      display: block;
    }

    /* –ö–ù–û–ü–ö–ê –ù–ê–ó–ê–î –í –ú–ï–ù–Æ */
    .back-to-menu {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      background: #1e2a3a;
      border: 2px solid #ffd966;
      color: #ffd966;
      font-size: clamp(18px, 3vw, 24px);
      font-weight: 700;
      padding: clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px);
      border-radius: 60px;
      cursor: pointer;
      margin-bottom: 20px;
      transition: 0.2s;
      box-shadow: 0 4px 0 #0f1a2a;
    }

    .back-to-menu:active {
      transform: translateY(4px);
      box-shadow: 0 1px 0 #0f1a2a;
    }

    .back-to-menu span {
      font-size: clamp(24px, 4vw, 32px);
    }

    /* CANVAS */
    .canvas-wrapper {
      width: 100%;
      aspect-ratio: 952/700;
      margin-bottom: 20px;
      border-radius: clamp(24px, 4vw, 36px);
      overflow: hidden;
      background: #0f1a24;
      box-shadow: inset 0 0 30px #00000099;
    }

    canvas {
      display: block;
      width: 100%;
      height: 100%;
      background: #0f1a24;
    }

    /* –ö–û–ù–¢–†–û–õ–´ PLINKO */
    .plinko-controls {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #1b2432;
      padding: clamp(15px, 2.5vw, 20px) clamp(20px, 3vw, 30px);
      border-radius: 60px;
      border: 1px solid #3a4a60;
      flex-wrap: wrap;
      gap: 15px;
    }

    .bet-section {
      display: flex;
      align-items: center;
      gap: clamp(10px, 2vw, 25px);
      background: #121b28;
      padding: clamp(6px, 1.5vw, 8px) clamp(15px, 3vw, 25px);
      border-radius: 50px;
      flex: 1;
      min-width: 250px;
    }

    .bet-label {
      color: #a5bbdd;
      font-size: clamp(16px, 2.5vw, 20px);
      font-weight: 500;
      white-space: nowrap;
    }

    .bet-input {
      background: #1f3147;
      border: 2px solid #ffd966;
      color: #ffd966;
      font-size: clamp(22px, 3.5vw, 28px);
      font-weight: 700;
      width: min(130px, 25vw);
      padding: clamp(8px, 1.5vw, 12px) clamp(12px, 2vw, 20px);
      border-radius: 50px;
      text-align: center;
      outline: none;
    }

    .drop-ball-btn {
      background: linear-gradient(145deg, #f0b429, #d4941f);
      border: none;
      font-size: clamp(22px, 4vw, 32px);
      font-weight: 800;
      padding: clamp(12px, 2vw, 16px) clamp(30px, 5vw, 60px);
      border-radius: 60px;
      color: #141e2c;
      cursor: pointer;
      box-shadow: 0 6px 0 #8f6016, 0 8px 25px #f0b429;
      transition: 0.08s linear;
      text-transform: uppercase;
      white-space: nowrap;
    }

    .drop-ball-btn:active {
      transform: translateY(6px);
      box-shadow: 0 2px 0 #8f6016, 0 8px 25px #f0b429;
    }

    .level-panel {
      display: flex;
      gap: clamp(8px, 1.5vw, 12px);
      margin-top: 16px;
      flex-wrap: wrap;
    }

    .level-btn {
      background: #253141;
      border: 2px solid #4d637f;
      color: #adc4f0;
      font-size: clamp(14px, 2.5vw, 18px);
      font-weight: 700;
      padding: clamp(8px, 1.5vw, 12px) clamp(15px, 3vw, 30px);
      border-radius: 40px;
      cursor: pointer;
      transition: 0.2s;
      flex: 1;
      min-width: 100px;
      text-align: center;
    }

    .level-btn.active {
      background: #ffd966;
      border-color: #fff1b0;
      color: #1a2538;
      box-shadow: 0 0 15px #ffd966;
    }

    /* –ü–∞–¥–∞—é—â–∏–µ –∑–≤–µ–∑–¥—ã */
    .star {
      position: fixed;
      background: white;
      border-radius: 50%;
      box-shadow: 0 0 10px white;
      pointer-events: none;
      z-index: 999;
    }

    @keyframes fallStar {
      0% { transform: translateY(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
    }
  </style>
</head>
<body>
  <!-- –ü–†–ò–í–ï–¢–°–¢–í–ï–ù–ù–´–ô –≠–ö–†–ê–ù -->
  <div class="welcome-screen" id="welcomeScreen">
    <div class="welcome-content">
      <div class="welcome-title">SMEET</div>
      <div class="welcome-subtitle">CASINO</div>
      <div class="loading-dots">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </div>

  <!-- –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† -->
  <div class="app" id="app">
    <!-- –®–ê–ü–ö–ê -->
    <div class="header">
      <div class="balance-block">
        <span class="stars-icon">‚≠ê</span>
        <span class="balance-value" id="balanceDisplay">1000</span>
      </div>
      <button class="add-stars-btn" id="addStarsBtn">
        <span>‚ûï</span> 1000 ‚≠ê
      </button>
    </div>

    <!-- –ú–ï–ù–Æ –ò–ì–† -->
    <div id="gamesMenu" class="games-menu">
      <div class="game-menu-item active" data-game="plinko">üé≤ PLINKO</div>
      <div class="game-menu-item disabled" data-game="dice">üé≤ DICE</div>
      <div class="game-menu-item disabled" data-game="slots">üé∞ SLOTS</div>
      <div class="game-menu-item disabled" data-game="roulette">üé° ROULETTE</div>
    </div>

    <!-- PLINKO -->
    <div id="plinkoContainer">
      <div class="back-to-menu" id="backToMenuBtn">
        <span>‚Üê</span> –í –ú–ï–ù–Æ
      </div>
      
      <div class="canvas-wrapper">
        <canvas id="plinkoCanvas" width="952" height="700"></canvas>
      </div>

      <div class="plinko-controls">
        <div class="bet-section">
          <span class="bet-label">–°–¢–ê–í–ö–ê ‚≠ê</span>
          <input type="number" id="betInput" class="bet-input" value="50" min="10" step="10">
        </div>
        <button class="drop-ball-btn" id="dropBallBtn">üé≤ –ö–ò–ù–£–¢–¨</button>
      </div>

      <div class="level-panel">
        <button class="level-btn active" data-level="easy">üå± –õ–Å–ì–ö–ò–ô</button>
        <button class="level-btn" data-level="medium">‚ö° –°–†–ï–î–ù–ò–ô</button>
        <button class="level-btn" data-level="hard">üî• –•–ê–†–î</button>
      </div>
    </div>
  </div>

  <script>
    (function() {
      // –ü–∞–¥–∞—é—â–∏–µ –∑–≤–µ–∑–¥—ã
      function createStar() {
        const star = document.createElement('div');
        star.className = 'star';
        star.style.left = Math.random() * 100 + '%';
        star.style.top = '-10px';
        star.style.width = star.style.height = (Math.random() * 4 + 2) + 'px';
        star.style.animation = `fallStar ${Math.random() * 3 + 2}s linear`;
        star.style.animationDelay = Math.random() * 2 + 's';
        document.body.appendChild(star);
        setTimeout(() => star.remove(), 5000);
      }

      setInterval(createStar, 2000);
      for (let i = 0; i < 10; i++) setTimeout(createStar, i * 200);

      // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ -> —Å—Ä–∞–∑—É –≤ –º–µ–Ω—é –∏–≥—Ä
      const welcomeScreen = document.getElementById('welcomeScreen');
      const app = document.getElementById('app');
      const gamesMenu = document.getElementById('gamesMenu');
      const plinkoContainer = document.getElementById('plinkoContainer');

      setTimeout(() => {
        welcomeScreen.style.opacity = '0';
        setTimeout(() => {
          welcomeScreen.style.display = 'none';
          app.classList.add('visible');
          gamesMenu.style.display = 'flex';
          plinkoContainer.style.display = 'none';
        }, 1000);
      }, 3000);

      // –ë–∞–ª–∞–Ω—Å
      let balance = 1000;
      const balanceEl = document.getElementById('balanceDisplay');

      function updateBalance() {
        balanceEl.innerText = balance;
      }

      document.getElementById('addStarsBtn').addEventListener('click', () => {
        balance += 1000;
        updateBalance();
      });

      // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –º–µ–Ω—é –∏ Plinko
      const backToMenuBtn = document.getElementById('backToMenuBtn');

      document.querySelectorAll('.game-menu-item').forEach(item => {
        item.addEventListener('click', () => {
          if (item.classList.contains('disabled')) return;
          
          const game = item.dataset.game;
          
          if (game === 'plinko') {
            gamesMenu.style.display = 'none';
            plinkoContainer.style.display = 'block';
            plinkoContainer.classList.add('active');
          }
        });
      });

      backToMenuBtn.addEventListener('click', () => {
        plinkoContainer.style.display = 'none';
        gamesMenu.style.display = 'flex';
      });

      // PLINKO
      const canvas = document.getElementById('plinkoCanvas');
      const ctx = canvas.getContext('2d');
      const width = 952, height = 700;

      let currentLevel = 'easy';
      let balls = [];
      let pins = [];
      let multipliers = [];

      // –ù–û–í–´–ï –ü–†–ê–í–ò–õ–¨–ù–´–ï –ö–û–≠–§–§–ò–¶–ò–ï–ù–¢–´:
      // –°–ª–∏–≤—ã (–º–∏–Ω—É—Å) - –≤ —Ü–µ–Ω—Ç—Ä–µ
      // –û—Ç —Ü–µ–Ω—Ç—Ä–∞ –∫ –∫—Ä–∞—è–º - —Ä–æ—Å—Ç –≤—ã–∏–≥—Ä—ã—à–∞
      const levelMultipliers = {
        easy:   [5.0, 3.0, 1.8, 1.2, 0.7, 0.3, 0.7, 1.2, 1.8, 3.0, 5.0],
        medium: [10.0, 5.0, 2.5, 1.5, 1.0, 0.5, 0.2, 0.5, 1.0, 1.5, 2.5, 5.0, 10.0],
        hard:   [50.0, 20.0, 10.0, 5.0, 2.5, 1.2, 0.5, 0.1, 0.5, 1.2, 2.5, 5.0, 10.0, 20.0, 50.0]
      };

      function generateField(level) {
        pins = [];
        const mults = levelMultipliers[level];
        
        // –†–∞—Å—à–∏—Ä—è–µ–º –ø–∏—Ä–∞–º–∏–¥—É - –±–æ–ª—å—à–µ —Ä—è–¥–æ–≤ –∏ –∫–æ–ª–æ–Ω–æ–∫
        const rows = 14; // –ë–æ–ª—å—à–µ —Ä—è–¥–æ–≤
        const startY = 80;
        const pinR = 5;
        const spacingX = 48; // –ß—É—Ç—å –º–µ–Ω—å—à–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ
        const spacingY = 36;

        // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ç–∞–∫, —á—Ç–æ–±—ã –ø–æ–∫—Ä—ã—Ç—å –≤—Å–µ —è—á–µ–π–∫–∏
        const maxCols = mults.length + 4; // –®–∏—Ä–µ –ø–æ–ª–µ
        const totalW = (maxCols - 1) * spacingX;
        const offsetX = (width - totalW) / 2;

        for (let row = 0; row < rows; row++) {
          // –ü–∏—Ä–∞–º–∏–¥–∞: —Ä–∞—Å—à–∏—Ä—è–µ–º—Å—è –¥–æ —Å–µ—Ä–µ–¥–∏–Ω—ã, –ø–æ—Ç–æ–º —Å—É–∂–∞–µ–º—Å—è
          let cols;
          if (row < 6) cols = 6 + row; // –†–∞—Å—Ç–µ—Ç
          else if (row < 9) cols = 12; // –ú–∞–∫—Å–∏–º—É–º
          else cols = 21 - row; // –°—É–∂–∞–µ—Ç—Å—è
          
          // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º, –Ω–æ –¥–µ–ª–∞–µ–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —à–∏—Ä–æ–∫–æ–π –¥–ª—è –∫—Ä–∞–π–Ω–∏—Ö —è—á–µ–µ–∫
          cols = Math.min(cols, mults.length + 5);
          
          const rowOffset = (maxCols - cols) * spacingX / 2;
          
          for (let col = 0; col < cols; col++) {
            // –°–º–µ—â–µ–Ω–∏–µ –¥–ª—è —á–µ—Ç–Ω—ã—Ö/–Ω–µ—á–µ—Ç–Ω—ã—Ö —Ä—è–¥–æ–≤
            const x = offsetX + rowOffset + col * spacingX + (row % 2 ? spacingX/2 : 0);
            const y = startY + row * spacingY;
            pins.push({ x, y, r: pinR });
          }
        }

        // –Ø—á–µ–π–∫–∏ —Å–Ω–∏–∑—É
        multipliers = [];
        const cellW = width / mults.length;
        for (let i = 0; i < mults.length; i++) {
          let color;
          const v = mults[i];
          if (v <= 0.5) color = '#6c7a96'; // –°–µ—Ä—ã–π (—Å–ª–∏–≤)
          else if (v <= 1.0) color = '#4f9fff'; // –°–∏–Ω–∏–π (–Ω–æ–ª—å)
          else if (v <= 2.0) color = '#42d692'; // –ó–µ–ª–µ–Ω—ã–π (–ø–ª—é—Å)
          else if (v <= 5.0) color = '#ffb347'; // –û—Ä–∞–Ω–∂ (—Ö2-—Ö5)
          else color = '#ff6b6b'; // –ö—Ä–∞—Å–Ω—ã–π (–¥–∂–µ–∫–ø–æ—Ç)
          
          multipliers.push({ 
            x: i * cellW, 
            w: cellW, 
            value: v, 
            color 
          });
        }
      }

      generateField(currentLevel);

      class Ball {
        constructor(x, y, bet) {
          this.x = x;
          this.y = y;
          this.vx = (Math.random() - 0.5) * 2.0; // –ë–æ–ª—å—à–µ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏
          this.vy = 0.8;
          this.r = 8;
          this.bet = bet;
          this.trail = [];
        }

        update() {
          this.vy += 0.22;
          this.vx *= 0.995;
          this.x += this.vx;
          this.y += this.vy;
          
          this.trail.push({x: this.x, y: this.y});
          if (this.trail.length > 8) this.trail.shift();

          // –û—Ç—Å–∫–æ–∫–∏ –æ—Ç —à—Ç—ã—Ä–µ–π
          for (let p of pins) {
            const dx = this.x - p.x;
            const dy = this.y - p.y;
            const dist = Math.sqrt(dx*dx + dy*dy);
            const minDist = this.r + p.r;
            
            if (dist < minDist) {
              const angle = Math.atan2(dy, dx);
              const overlap = minDist - dist;
              this.x += Math.cos(angle) * overlap * 0.7;
              this.y += Math.sin(angle) * overlap * 0.7;
              
              const speed = Math.sqrt(this.vx*this.vx + this.vy*this.vy);
              if (speed > 0.1) {
                const nx = dx/dist;
                const ny = dy/dist;
                const dot = this.vx * nx + this.vy * ny;
                
                // –†–∞–∑–Ω—ã–π –æ—Ç—Å–∫–æ–∫ –¥–ª—è –±–æ–ª–µ–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
                this.vx = (this.vx - 1.4 * dot * nx) * 0.7;
                this.vy = (this.vy - 1.4 * dot * ny) * 0.7;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–º–Ω–æ–≥–æ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –æ—Ç—Å–∫–æ–∫–µ
                this.vx += (Math.random() - 0.5) * 0.5;
                this.vy += (Math.random() - 0.5) * 0.3;
              }
            }
          }

          // –ë–æ–∫–æ–≤—ã–µ —Å—Ç–µ–Ω–∫–∏
          if (this.x - this.r < 10) {
            this.x = 10 + this.r;
            this.vx *= -0.6;
          }
          if (this.x + this.r > width - 10) {
            this.x = width - 10 - this.r;
            this.vx *= -0.6;
          }

          // –î–æ—Å—Ç–∏–≥ –¥–Ω–∞?
          if (this.y + this.r > height - 55) {
            const idx = Math.floor(this.x / (width / multipliers.length));
            if (idx >= 0 && idx < multipliers.length) {
              const win = Math.floor(this.bet * multipliers[idx].value);
              balance += win;
              updateBalance();
              flashCell(idx);
            }
            return false;
          }
          return true;
        }
      }

      let flash = { active: false, index: -1, alpha: 0 };
      function flashCell(idx) {
        flash.active = true;
        flash.index = idx;
        flash.alpha = 1;
      }

      function draw() {
        ctx.clearRect(0, 0, width, height);
        
        const grad = ctx.createLinearGradient(0, 0, 0, height);
        grad.addColorStop(0, '#0a1a2a');
        grad.addColorStop(1, '#1a2a3a');
        ctx.fillStyle = grad;
        ctx.fillRect(0, 0, width, height);

        // –†–∏—Å—É–µ–º —à—Ç—ã—Ä–∏
        pins.forEach(p => {
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
          
          const gradPin = ctx.createRadialGradient(p.x-2, p.y-2, 2, p.x, p.y, p.r+2);
          gradPin.addColorStop(0, '#ffd966');
          gradPin.addColorStop(0.7, '#b8860b');
          gradPin.addColorStop(1, '#8b6508');
          
          ctx.fillStyle = gradPin;
          ctx.shadowColor = '#ffd966';
          ctx.shadowBlur = 10;
          ctx.fill();
          
          ctx.shadowBlur = 0;
          ctx.beginPath();
          ctx.arc(p.x-1.5, p.y-1.5, 1.5, 0, Math.PI*2);
          ctx.fillStyle = 'rgba(255,255,220,0.7)';
          ctx.fill();
        });

        // –†–∏—Å—É–µ–º —è—á–µ–π–∫–∏ —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏
        multipliers.forEach((m, i) => {
          ctx.fillStyle = m.color + '80';
          ctx.fillRect(m.x, height-60, m.w-1, 45);
          
          if (flash.active && flash.index === i) {
            ctx.fillStyle = `rgba(255,255,255,${flash.alpha})`;
            ctx.fillRect(m.x, height-60, m.w-1, 45);
            flash.alpha *= 0.6;
            if (flash.alpha < 0.05) flash.active = false;
          }
          
          ctx.strokeStyle = '#ffffff40';
          ctx.lineWidth = 2;
          ctx.strokeRect(m.x, height-60, m.w-1, 45);
          
          ctx.font = 'bold 20px "Segoe UI"';
          ctx.fillStyle = '#ffffff';
          ctx.shadowColor = '#000';
          ctx.shadowBlur = 5;
          ctx.textAlign = 'center';
          
          let text = m.value.toFixed(1);
          if (m.value < 1) text = m.value.toFixed(1);
          else if (m.value < 10) text = 'x' + m.value.toFixed(1);
          else text = 'x' + Math.round(m.value);
          
          ctx.fillText(text, m.x + m.w/2, height-32);
        });
        ctx.shadowBlur = 0;

        // –†–∏—Å—É–µ–º —à–∞—Ä–∏–∫–∏
        balls.forEach(b => {
          // –°–ª–µ–¥
          b.trail.forEach((t, i) => {
            const alpha = (i / b.trail.length) * 0.3;
            ctx.beginPath();
            ctx.arc(t.x, t.y, b.r*0.6, 0, Math.PI*2);
            ctx.fillStyle = `rgba(255,100,100,${alpha})`;
            ctx.fill();
          });
          
          // –®–∞—Ä–∏–∫
          ctx.beginPath();
          ctx.arc(b.x, b.y, b.r, 0, Math.PI*2);
          const gradBall = ctx.createRadialGradient(b.x-3, b.y-3, 3, b.x, b.y, b.r+2);
          gradBall.addColorStop(0, '#ffcccc');
          gradBall.addColorStop(0.5, '#ff4444');
          gradBall.addColorStop(1, '#aa2222');
          ctx.fillStyle = gradBall;
          ctx.shadowColor = '#ff8888';
          ctx.shadowBlur = 15;
          ctx.fill();
          
          ctx.shadowBlur = 0;
          ctx.beginPath();
          ctx.arc(b.x-2, b.y-2, 2, 0, Math.PI*2);
          ctx.fillStyle = 'rgba(255,255,255,0.4)';
          ctx.fill();
        });
      }

      function gameLoop() {
        for (let i = balls.length - 1; i >= 0; i--) {
          if (!balls[i].update()) balls.splice(i, 1);
        }
        draw();
        requestAnimationFrame(gameLoop);
      }
      gameLoop();

      document.getElementById('dropBallBtn').addEventListener('click', () => {
        const betInput = document.getElementById('betInput');
        let bet = parseInt(betInput.value);
        if (isNaN(bet) || bet < 10) bet = 10;
        if (bet > balance) {
          alert('‚ùå –ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –∑–≤—ë–∑–¥!');
          return;
        }
        
        balance -= bet;
        updateBalance();
        
        // –ù–µ–±–æ–ª—å—à–∞—è —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å —Å—Ç–∞—Ä—Ç–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏
        const startX = width/2 + (Math.random() * 40 - 20);
        balls.push(new Ball(startX, 40, bet));
      });

      document.querySelectorAll('.level-btn').forEach(btn => {
        btn.addEventListener('click', e => {
          document.querySelectorAll('.level-btn').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          currentLevel = btn.dataset.level;
          generateField(currentLevel);
        });
      });

      document.getElementById('betInput').addEventListener('change', function() {
        let v = parseInt(this.value);
        if (v < 10) this.value = 10;
        if (v > 10000) this.value = 10000;
      });

      updateBalance();
    })();
  </script>
</body>
</html>
