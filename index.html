<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SMEET CASINO</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', system-ui, sans-serif;
      user-select: none;
    }

    body {
      background: #0b0e14;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    /* –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† */
    .app {
      width: 1000px;
      background: #141a24;
      border-radius: 48px;
      padding: 24px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.8), inset 0 1px 2px rgba(255, 255, 255, 0.05);
      border: 1px solid #2d3848;
    }

    /* –®–ê–ü–ö–ê –° –ë–ê–õ–ê–ù–°–û–ú */
    .header {
      background: #0f151f;
      border-radius: 100px;
      padding: 15px 30px;
      margin-bottom: 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border: 1px solid #334153;
      box-shadow: inset 0 2px 5px #00000055;
    }

    .balance-block {
      display: flex;
      align-items: center;
      gap: 20px;
      background: #1a2332;
      padding: 8px 30px 8px 20px;
      border-radius: 60px;
      border: 1px solid #4d607c;
    }

    .stars-icon {
      font-size: 32px;
      filter: drop-shadow(0 0 8px gold);
    }

    .balance-value {
      font-size: 36px;
      font-weight: 800;
      color: #ffd966;
      text-shadow: 0 0 10px #f0b429;
    }

    .add-stars-btn {
      background: linear-gradient(145deg, #2a3a55, #1b263b);
      border: 2px solid #ffd966;
      color: #ffd966;
      font-size: 20px;
      font-weight: 700;
      padding: 12px 30px;
      border-radius: 60px;
      cursor: pointer;
      transition: 0.2s;
      box-shadow: 0 5px 0 #0f1a2a;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .add-stars-btn:active {
      transform: translateY(4px);
      box-shadow: 0 1px 0 #0f1a2a;
    }

    /* –ú–ï–ù–Æ –ò–ì–† */
    .games-menu {
      display: flex;
      gap: 15px;
      margin-bottom: 24px;
      flex-wrap: wrap;
    }

    .game-card {
      background: #1e2a3a;
      border: 2px solid #3e536a;
      border-radius: 30px;
      padding: 16px 35px;
      font-size: 24px;
      font-weight: 700;
      color: #b7ccf0;
      cursor: pointer;
      transition: 0.2s;
      text-transform: uppercase;
      letter-spacing: 1px;
      flex: 1;
      text-align: center;
    }

    .game-card.active {
      background: #ffd966;
      border-color: #fff0b5;
      color: #141e30;
      box-shadow: 0 0 20px #ffd966;
      transform: scale(1.02);
    }

    .game-card.disabled {
      opacity: 0.4;
      cursor: not-allowed;
      filter: grayscale(0.8);
    }

    /* –ò–ì–†–û–í–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† PLINKO */
    #plinkoContainer {
      display: block;
    }

    canvas {
      display: block;
      width: 952px;
      height: 700px;
      border-radius: 36px;
      background: #0f1a24;
      box-shadow: inset 0 0 30px #00000099, 0 10px 20px black;
      margin-bottom: 20px;
    }

    .plinko-controls {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #1b2432;
      padding: 20px 30px;
      border-radius: 60px;
      border: 1px solid #3a4a60;
    }

    .bet-section {
      display: flex;
      align-items: center;
      gap: 25px;
      background: #121b28;
      padding: 8px 25px;
      border-radius: 50px;
    }

    .bet-label {
      color: #a5bbdd;
      font-size: 20px;
      font-weight: 500;
    }

    .bet-input {
      background: #1f3147;
      border: 2px solid #ffd966;
      color: #ffd966;
      font-size: 28px;
      font-weight: 700;
      width: 130px;
      padding: 12px 20px;
      border-radius: 50px;
      text-align: center;
      outline: none;
    }

    .drop-ball-btn {
      background: linear-gradient(145deg, #f0b429, #d4941f);
      border: none;
      font-size: 32px;
      font-weight: 800;
      padding: 16px 60px;
      border-radius: 60px;
      color: #141e2c;
      cursor: pointer;
      box-shadow: 0 8px 0 #8f6016, 0 8px 25px #f0b429;
      transition: 0.08s linear;
      text-transform: uppercase;
    }

    .drop-ball-btn:active {
      transform: translateY(6px);
      box-shadow: 0 2px 0 #8f6016, 0 8px 25px #f0b429;
    }

    .level-panel {
      display: flex;
      gap: 12px;
      margin-top: 16px;
    }

    .level-btn {
      background: #253141;
      border: 2px solid #4d637f;
      color: #adc4f0;
      font-size: 18px;
      font-weight: 700;
      padding: 12px 30px;
      border-radius: 40px;
      cursor: pointer;
      transition: 0.2s;
      flex: 1;
    }

    .level-btn.active {
      background: #ffd966;
      border-color: #fff1b0;
      color: #1a2538;
      box-shadow: 0 0 15px #ffd966;
    }
  </style>
</head>
<body>
<div class="app">
  <!-- –®–ê–ü–ö–ê -->
  <div class="header">
    <div class="balance-block">
      <span class="stars-icon">‚≠ê</span>
      <span class="balance-value" id="balanceDisplay">1000</span>
    </div>
    <button class="add-stars-btn" id="addStarsBtn">
      <span>‚ûï</span> 1000 ‚≠ê
    </button>
  </div>

  <!-- –ú–ï–ù–Æ –ò–ì–† -->
  <div class="games-menu">
    <div class="game-card active" data-game="plinko">üé≤ PLINKO</div>
    <div class="game-card disabled" data-game="dice">üé≤ DICE (soon)</div>
    <div class="game-card disabled" data-game="slots">üé∞ SLOTS (soon)</div>
    <div class="game-card disabled" data-game="roulette">üé° ROULETTE (soon)</div>
  </div>

  <!-- PLINKO –ö–û–ù–¢–ï–ô–ù–ï–† -->
  <div id="plinkoContainer">
    <canvas id="plinkoCanvas" width="952" height="700"></canvas>

    <div class="plinko-controls">
      <div class="bet-section">
        <span class="bet-label">–°–¢–ê–í–ö–ê ‚≠ê</span>
        <input type="number" id="betInput" class="bet-input" value="50" min="10" step="10">
      </div>
      <button class="drop-ball-btn" id="dropBallBtn">üé≤ –ö–ò–ù–£–¢–¨</button>
    </div>

    <div class="level-panel">
      <button class="level-btn active" data-level="easy">üå± –õ–Å–ì–ö–ò–ô</button>
      <button class="level-btn" data-level="medium">‚ö° –°–†–ï–î–ù–ò–ô</button>
      <button class="level-btn" data-level="hard">üî• –•–ê–†–î</button>
    </div>
  </div>
</div>

<script>
(function() {
  // ---------- –ë–ê–õ–ê–ù–° (–ó–í–Å–ó–î–´) ----------
  let balance = 1000;
  const balanceEl = document.getElementById('balanceDisplay');

  function updateBalanceDisplay() {
    balanceEl.innerText = balance;
  }

  // –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ 1000 –∑–≤—ë–∑–¥
  document.getElementById('addStarsBtn').addEventListener('click', () => {
    balance += 1000;
    updateBalanceDisplay();
  });

  // ---------- PLINKO ----------
  const canvas = document.getElementById('plinkoCanvas');
  const ctx = canvas.getContext('2d');
  const width = 952, height = 700;
  canvas.width = width; canvas.height = height;

  let currentLevel = 'easy';
  let balls = [];
  let pins = [];
  let multipliers = [];

  // –ú–Ω–æ–∂–∏—Ç–µ–ª–∏
  const levelMultipliers = {
    easy:   [1.2, 1.5, 2.0, 3.0, 5.0, 3.0, 2.0, 1.5, 1.2],
    medium: [0.7, 1.0, 1.5, 3.0, 10.0, 3.0, 1.5, 1.0, 0.7],
    hard:   [0.3, 0.7, 1.2, 2.5, 20.0, 50.0, 20.0, 2.5, 1.2, 0.7, 0.3]
  };

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–ª—è
  function generatePlinkoField(level) {
    pins = [];
    const mults = levelMultipliers[level] || levelMultipliers.easy;
    const rows = 12;
    const startY = 100;
    const pinRadius = 5;
    const spacingX = 52;
    const spacingY = 38;

    const maxCols = mults.length + 2;
    const totalWidth = (maxCols - 1) * spacingX;
    const offsetX = (width - totalWidth) / 2;

    for (let row = 0; row < rows; row++) {
      let cols;
      if (row < 5) cols = 5 + row;
      else if (row < 8) cols = 9;
      else cols = 17 - row;
      cols = Math.min(cols, mults.length + 3);
      
      const rowOffsetX = (maxCols - cols) * spacingX / 2;
      
      for (let col = 0; col < cols; col++) {
        const x = offsetX + rowOffsetX + col * spacingX + (row % 2 === 0 ? spacingX/2 : 0);
        const y = startY + row * spacingY;
        pins.push({ x, y, r: pinRadius });
      }
    }

    // –Ø—á–µ–π–∫–∏
    multipliers = [];
    const cellWidth = width / mults.length;
    for (let i = 0; i < mults.length; i++) {
      let color;
      const val = mults[i];
      if (val < 1) color = '#6c7a96';
      else if (val < 2) color = '#4f9fff';
      else if (val < 4) color = '#42d692';
      else if (val < 8) color = '#ffb347';
      else color = '#ff6b6b';
      
      multipliers.push({
        x: i * cellWidth,
        w: cellWidth,
        value: val,
        color: color
      });
    }
  }

  generatePlinkoField(currentLevel);

  // –ö–ª–∞—Å—Å —à–∞—Ä–∏–∫–∞
  class Ball {
    constructor(x, y, bet) {
      this.x = x;
      this.y = y;
      this.vx = (Math.random() - 0.5) * 1.5;
      this.vy = 1.0;
      this.radius = 9;
      this.bet = bet;
      this.trail = [];
    }

    update() {
      this.vy += 0.25;
      this.vx *= 0.995;
      
      this.x += this.vx;
      this.y += this.vy;
      
      this.trail.push({x: this.x, y: this.y});
      if (this.trail.length > 8) this.trail.shift();

      // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å–æ —à—Ç—ã—Ä—è–º–∏
      for (let pin of pins) {
        const dx = this.x - pin.x;
        const dy = this.y - pin.y;
        const dist = Math.sqrt(dx * dx + dy * dy);
        const minDist = this.radius + pin.r;
        
        if (dist < minDist) {
          const angle = Math.atan2(dy, dx);
          const overlap = minDist - dist;
          
          this.x += Math.cos(angle) * overlap * 0.8;
          this.y += Math.sin(angle) * overlap * 0.8;
          
          const speed = Math.sqrt(this.vx * this.vx + this.vy * this.vy);
          if (speed > 0.1) {
            const nx = dx / dist;
            const ny = dy / dist;
            const dot = this.vx * nx + this.vy * ny;
            
            this.vx = (this.vx - 1.6 * dot * nx) * 0.75;
            this.vy = (this.vy - 1.6 * dot * ny) * 0.75;
          }
        }
      }

      // –ì—Ä–∞–Ω–∏—Ü—ã
      if (this.x - this.radius < 15) {
        this.x = 15 + this.radius;
        this.vx *= -0.7;
      }
      if (this.x + this.radius > width - 15) {
        this.x = width - 15 - this.radius;
        this.vx *= -0.7;
      }

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–Ω–∏—à–∞
      if (this.y + this.radius > height - 55) {
        const cellIndex = Math.floor(this.x / (width / multipliers.length));
        if (cellIndex >= 0 && cellIndex < multipliers.length) {
          const mult = multipliers[cellIndex].value;
          const win = Math.floor(this.bet * mult);
          balance += win;
          updateBalanceDisplay();
          flashCell(cellIndex);
        }
        return false;
      }
      return true;
    }
  }

  // –≠—Ñ—Ñ–µ–∫—Ç –≤—Å–ø—ã—à–∫–∏
  let flashData = { active: false, index: -1, alpha: 0 };
  function flashCell(index) {
    flashData.active = true;
    flashData.index = index;
    flashData.alpha = 1.0;
  }

  // –û—Ç—Ä–∏—Å–æ–≤–∫–∞
  function draw() {
    ctx.clearRect(0, 0, width, height);
    
    // –§–æ–Ω
    const grad = ctx.createLinearGradient(0, 0, 0, height);
    grad.addColorStop(0, '#10212e');
    grad.addColorStop(1, '#1d3142');
    ctx.fillStyle = grad;
    ctx.fillRect(0, 0, width, height);

    // –®—Ç—ã—Ä–∏
    pins.forEach(p => {
      ctx.beginPath();
      ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
      ctx.fillStyle = '#d4af37';
      ctx.shadowColor = '#ffd966';
      ctx.shadowBlur = 8;
      ctx.fill();
      ctx.shadowBlur = 0;
    });

    // –Ø—á–µ–π–∫–∏
    multipliers.forEach((m, i) => {
      ctx.fillStyle = m.color + '33';
      ctx.fillRect(m.x, height-60, m.w-1, 45);
      
      if (flashData.active && flashData.index === i) {
        ctx.fillStyle = `rgba(255,255,255,${flashData.alpha})`;
        ctx.fillRect(m.x, height-60, m.w-1, 45);
        flashData.alpha *= 0.6;
        if (flashData.alpha < 0.05) flashData.active = false;
      }
      
      ctx.strokeStyle = '#5a779c';
      ctx.lineWidth = 2;
      ctx.strokeRect(m.x, height-60, m.w-1, 45);
      
      ctx.font = 'bold 22px "Segoe UI"';
      ctx.fillStyle = 'white';
      ctx.shadowColor = '#000';
      ctx.shadowBlur = 8;
      ctx.textAlign = 'center';
      ctx.fillText('x' + m.value.toFixed(1), m.x + m.w/2, height-32);
      ctx.shadowBlur = 0;
    });

    // –®–∞—Ä–∏–∫–∏
    balls.forEach(b => {
      // –°–ª–µ–¥
      b.trail.forEach((t, idx) => {
        const alpha = (idx / b.trail.length) * 0.3;
        ctx.beginPath();
        ctx.arc(t.x, t.y, b.radius*0.7, 0, Math.PI*2);
        ctx.fillStyle = `rgba(255,80,80,${alpha})`;
        ctx.fill();
      });
      
      // –®–∞—Ä–∏–∫
      ctx.beginPath();
      ctx.arc(b.x, b.y, b.radius, 0, Math.PI*2);
      const gradBall = ctx.createRadialGradient(b.x-3, b.y-3, 3, b.x, b.y, b.radius+2);
      gradBall.addColorStop(0, '#ffaaaa');
      gradBall.addColorStop(1, '#c03030');
      ctx.fillStyle = gradBall;
      ctx.shadowColor = '#ff6060';
      ctx.shadowBlur = 20;
      ctx.fill();
      ctx.shadowBlur = 0;
    });
  }

  // –ê–Ω–∏–º–∞—Ü–∏—è
  function gameLoop() {
    for (let i = balls.length - 1; i >= 0; i--) {
      if (!balls[i].update()) balls.splice(i, 1);
    }
    draw();
    requestAnimationFrame(gameLoop);
  }
  gameLoop();

  // –ö–Ω–æ–ø–∫–∞ –±—Ä–æ—Å–∫–∞
  document.getElementById('dropBallBtn').addEventListener('click', () => {
    const betInput = document.getElementById('betInput');
    let bet = parseInt(betInput.value);
    if (isNaN(bet) || bet < 10) bet = 10;
    if (bet > balance) {
      alert('‚ùå –ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –∑–≤—ë–∑–¥!');
      return;
    }
    
    balance -= bet;
    updateBalanceDisplay();
    
    const startX = width/2 + (Math.random()*30 - 15);
    balls.push(new Ball(startX, 45, bet));
  });

  // –°–º–µ–Ω–∞ —É—Ä–æ–≤–Ω—è
  document.querySelectorAll('.level-btn').forEach(btn => {
    btn.addEventListener('click', e => {
      document.querySelectorAll('.level-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      currentLevel = btn.dataset.level;
      generatePlinkoField(currentLevel);
    });
  });

  // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∏–≥—Ä (–∑–∞–≥–ª—É—à–∫–∞)
  document.querySelectorAll('.game-card').forEach(card => {
    card.addEventListener('click', () => {
      if (card.classList.contains('disabled')) return;
      document.querySelectorAll('.game-card').forEach(c => c.classList.remove('active'));
      card.classList.add('active');
      // –ó–¥–µ—Å—å –ø–æ—Ç–æ–º –±—É–¥–µ–º –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏–≥—Ä
    });
  });

  // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏
  document.getElementById('betInput').addEventListener('change', function() {
    let v = parseInt(this.value);
    if (v < 10) this.value = 10;
    if (v > 10000) this.value = 10000;
  });

  updateBalanceDisplay();
})();
</script>
</body>
</html>
